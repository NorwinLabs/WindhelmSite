<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Your Orders - Windhelm®"
    />
    <meta
      name="keywords"
      content="Windhelm, orders, purchases, account"
    />
    <title>Your Orders - Windhelm®</title>

    <!-- Favicon -->
    <link rel="icon" href="images/favicon.png" />

    <!-- Preload critical resources -->
    <link
      rel="preload"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap"
      as="style"
      onload="this.onload=null;this.rel='stylesheet'"
    />
    <link rel="preload" href="images/Logo.png" as="image" type="image/png" />

    <!-- Critical CSS -->
    <style>
      :root {
        --primary-color: #2563eb;
        --primary-dark: #1d4ed8;
        --white: #ffffff;
        --gray-50: #f9fafb;
        --gray-100: #f3f4f6;
        --gray-200: #e5e7eb;
        --gray-400: #9ca3af;
        --gray-600: #4b5563;
        --gray-700: #374151;
        --gray-800: #1f2937;
        --gray-900: #111827;
        --font-primary: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI",
          Roboto, sans-serif;
        --font-display: "Space Grotesk", "Inter", sans-serif;
        --space-4: 1rem;
        --space-6: 1.5rem;
        --space-8: 2rem;
        --space-20: 5rem;
        --container-max-width: 1200px;
        --container-padding: 1.5rem;
        --border-radius: 0.5rem;
        --border-radius-lg: 0.75rem;
        --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1),
          0 1px 2px 0 rgba(0, 0, 0, 0.06);
        --transition-base: all 0.2s ease;
      }
      *,
      *::before,
      *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      html {
        scroll-behavior: smooth;
        font-size: 16px;
      }
      body {
        font-family: var(--font-primary);
        font-size: 1rem;
        line-height: 1.6;
        color: var(--gray-800);
        background: url("images/islandbg.png") repeat;
        background-attachment: fixed;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        min-height: 100vh;
        /* Custom Medieval Bronze Cursor */
        cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><defs><linearGradient id="bronze" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:%23CD7F32;stop-opacity:1" /><stop offset="30%" style="stop-color:%23B8860B;stop-opacity:1" /><stop offset="70%" style="stop-color:%23A0522D;stop-opacity:1" /><stop offset="100%" style="stop-color:%23654321;stop-opacity:1" /></linearGradient></defs><path d="M2 2 L2 18 L7 13 L10 13 L15 22 L17 21 L12 12 L15 12 L2 2 Z" fill="url(%23bronze)" stroke="%232F1B14" stroke-width="0.5"/></svg>')
            2 2,
          auto;
      }
      .container {
        max-width: var(--container-max-width);
        margin: 0 auto;
        padding: 0 var(--container-padding);
      }
      .header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000;
        background: url("images/islandbg.png") repeat,
          linear-gradient(rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));
        background-blend-mode: overlay;
        backdrop-filter: blur(8px);
        border-bottom: 1px solid rgba(229, 231, 235, 0.6);
        transition: var(--transition-base);
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .nav-container {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: var(--space-4) var(--container-padding);
        max-width: var(--container-max-width);
        margin: 0 auto;
      }
      .logo {
        display: flex;
        align-items: center;
      }
      .logo img {
        height: 40px;
        width: auto;
      }
      .nav-menu {
        display: flex;
        align-items: center;
        gap: var(--space-8);
      }
      .nav-link {
        font-weight: 500;
        color: #000000;
        padding: 0.5rem 0.75rem;
        border-radius: var(--border-radius);
        transition: var(--transition-base);
        text-decoration: none;
      }
      .nav-link:hover {
        background-color: var(--gray-100);
        color: var(--primary-color);
        transform: translateY(-1px);
      }
      .nav-link:active,
      .nav-link.active {
        background-color: var(--primary-color);
        color: var(--white);
      }
      .social-links {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 0.75rem;
      }
      .social-link {
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: var(--border-radius);
        color: var(--gray-600);
        transition: var(--transition-base);
        position: relative;
      }
      .social-link:hover {
        color: var(--primary-color);
        background-color: rgba(37, 99, 235, 0.1);
        transform: translateY(-2px) scale(1.05);
      }
      .social-link:hover svg {
        transform: scale(1.1);
      }
      .social-link svg {
        width: 20px;
        height: 20px;
      }
      .nav-toggle {
        display: none;
        flex-direction: column;
        gap: 4px;
        width: 24px;
        height: 24px;
        border: none;
        background: none;
        cursor: pointer;
      }
      .nav-toggle span {
        width: 100%;
        height: 2px;
        background: var(--gray-700);
        border-radius: 1px;
        transition: var(--transition-base);
      }
      .nav-toggle.active span:nth-child(1) {
        transform: rotate(45deg) translate(5px, 5px);
      }
      .nav-toggle.active span:nth-child(2) {
        opacity: 0;
      }
      .nav-toggle.active span:nth-child(3) {
        transform: rotate(-45deg) translate(7px, -6px);
      }
      .main-content {
        padding-top: 100px;
        min-height: calc(100vh - 200px);
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .orders-container {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border-radius: 1rem;
        padding: 3rem;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1),
          0 10px 10px -5px rgba(0, 0, 0, 0.04);
        max-width: 800px;
        width: 100%;
        margin: 2rem;
      }
      .orders-header {
        text-align: center;
        margin-bottom: 2rem;
        padding-bottom: 1.5rem;
        border-bottom: 2px solid #e2e8f0;
      }
      .orders-header h1 {
        font-family: var(--font-display);
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--gray-900);
        margin-bottom: 0.5rem;
      }
      .orders-header p {
        color: var(--gray-600);
        font-size: 1.1rem;
      }
      .user-info {
        background: linear-gradient(135deg, #f8fafc, #f1f5f9);
        border-radius: 0.75rem;
        padding: 1.5rem;
        margin-bottom: 2rem;
        border: 1px solid #e2e8f0;
      }
      .user-info p {
        margin: 0;
        font-size: 1.1rem;
        color: var(--gray-800);
        font-weight: 500;
      }
      .user-info .username {
        color: var(--primary-color);
        font-weight: 600;
      }
      .orders-list {
        margin-top: 2rem;
      }
      .order-item {
        background: #ffffff;
        border: 1px solid #e2e8f0;
        border-radius: 0.75rem;
        padding: 1.5rem;
        margin-bottom: 1rem;
        transition: var(--transition-base);
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }
      .order-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }
      .order-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 1rem;
        flex-wrap: wrap;
        gap: 0.5rem;
      }
      .order-id {
        font-size: 1.3rem;
        font-weight: 700;
        color: var(--gray-900);
        margin: 0;
      }
      .order-date {
        color: var(--gray-600);
        font-size: 0.95rem;
        font-weight: 500;
        background: #f8fafc;
        padding: 0.25rem 0.75rem;
        border-radius: 0.5rem;
        border: 1px solid #e2e8f0;
      }
      .order-details p {
        margin: 0.5rem 0;
        color: var(--gray-700);
        font-size: 1rem;
      }
      .order-details strong {
        color: var(--gray-900);
        font-weight: 600;
      }
      .no-orders {
        text-align: center;
        padding: 3rem;
        color: var(--gray-600);
      }
      .no-orders p {
        margin: 0 0 0.5rem 0;
        font-size: 1.2rem;
        font-weight: 500;
      }
      .no-orders .subtitle {
        font-size: 1rem;
        color: var(--gray-500);
      }
      .loading {
        text-align: center;
        padding: 3rem;
        color: var(--gray-600);
      }
      .loading p {
        margin: 0 0 1rem 0;
        font-size: 1.1rem;
      }
      .spinner {
        display: inline-block;
        width: 24px;
        height: 24px;
        border: 3px solid #e2e8f0;
        border-radius: 50%;
        border-top-color: var(--primary-color);
        animation: spin 1s linear infinite;
        margin-right: 0.5rem;
      }
      .actions {
        text-align: center;
        margin-top: 2rem;
        padding-top: 2rem;
        border-top: 1px solid #e2e8f0;
      }
      .btn {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1.5rem;
        border-radius: 0.5rem;
        font-weight: 600;
        font-size: 1rem;
        text-decoration: none;
        transition: var(--transition-base);
        cursor: pointer;
        border: none;
      }
      .btn-primary {
        background: var(--primary-color);
        color: var(--white);
      }
      .btn-primary:hover {
        background: var(--primary-dark);
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
      }
      .btn-secondary {
        background: transparent;
        color: var(--gray-700);
        border: 2px solid var(--gray-300);
      }
      .btn-secondary:hover {
        background: var(--gray-50);
        border-color: var(--gray-400);
        transform: translateY(-1px);
      }
      .error {
        text-align: center;
        padding: 3rem;
        color: #ef4444;
      }
      .error p {
        margin: 0;
        font-size: 1.1rem;
        font-weight: 500;
      }
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
      @media (max-width: 768px) {
        .nav-menu {
          position: fixed;
          top: 80px;
          left: -100%;
          width: 80vw;
          max-width: 340px;
          height: calc(100vh - 80px);
          background: rgba(255, 255, 255, 0.97);
          box-shadow: 2px 0 24px rgba(0, 0, 0, 0.1);
          backdrop-filter: blur(10px);
          flex-direction: column;
          justify-content: flex-start;
          align-items: flex-start;
          gap: 2rem;
          padding: 2.5rem 2rem 2rem 2rem;
          transition: left 0.32s cubic-bezier(0.77, 0, 0.18, 1);
          z-index: 1001;
        }
        .nav-menu.active {
          left: 0;
        }
        .nav-menu .nav-link {
          font-size: 1.25rem;
          padding: 1rem 0;
          width: 100%;
          text-align: left;
        }
        .nav-toggle {
          display: flex;
        }
        .nav-overlay {
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          width: 100vw;
          height: 100vh;
          background: rgba(0, 0, 0, 0.32);
          z-index: 1000;
          transition: opacity 0.25s;
          opacity: 0;
        }
        .nav-overlay.active {
          display: block;
          opacity: 1;
        }
        .orders-container {
          padding: 2rem 1.5rem;
          margin: 1rem;
        }
        .orders-header h1 {
          font-size: 2rem;
        }
        .order-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 0.5rem;
        }
        .order-date {
          align-self: flex-end;
        }
      }
    </style>
  </head>
  <body>
    <!-- Navigation Header -->
    <header class="header">
      <nav class="nav" role="navigation" aria-label="Main Navigation">
        <div class="nav-container">
          <a href="index.html" class="logo">
            <img
              src="images/Logo.png"
              alt="Windhelm Logo"
              width="120"
              height="55"
            />
          </a>

          <div class="nav-menu" id="nav-menu">
            <a href="index.html" class="nav-link">Home</a>
            <a href="index.html#features" class="nav-link">Features</a>
            <a href="index.html#team" class="nav-link">Team</a>
            <a href="index.html#contact" class="nav-link">Contact</a>
          </div>

          <div class="social-links">
            <a
              href="https://www.youtube.com/@NorwinLabs"
              target="_blank"
              rel="noopener"
              aria-label="YouTube"
              class="social-link"
            >
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path
                  d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"
                />
              </svg>
            </a>
            <a
              href="https://discord.gg/PgGA8Zsj4g"
              target="_blank"
              rel="noopener"
              aria-label="Discord"
              class="social-link"
            >
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path
                  d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.211.375-.445.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028c.462-.63.874-1.295 1.226-1.994a.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"
                />
              </svg>
            </a>
            <a
              href="https://store.steampowered.com/app/2171040/Windhelm/"
              target="_blank"
              rel="noopener"
              aria-label="Steam"
              class="social-link"
            >
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path
                  d="M11.979 0C5.678 0 .511 4.86.022 11.037l6.432 2.658c.545-.371 1.203-.59 1.912-.59.063 0 .125.004.188.006l2.861-4.142V8.91c0-2.495 2.028-4.524 4.524-4.524 2.494 0 4.524 2.031 4.524 4.527s-2.03 4.525-4.524 4.525h-.105l-4.076 2.911c0 .052.004.105.004.159 0 1.875-1.515 3.396-3.39 3.396-1.635 0-3.016-1.173-3.331-2.727L.436 15.27C1.62 20.51 6.363 24 11.979 24c6.624 0 11.979-5.354 11.979-11.979C23.958 5.354 18.603.001 11.979.001zM7.54 18.21l-1.473-.61c.262.543.714.999 1.314 1.25 1.297.539 2.793-.076 3.332-1.375.263-.63.264-1.319.005-1.949s-.75-1.121-1.377-1.383c-.624-.26-1.29-.249-1.878-.03l1.523.63c.956.4 1.409 1.5 1.009 2.455-.397.957-1.497 1.41-2.454 1.012H7.54zm11.415-9.303c0-1.66-1.353-3.015-3.015-3.015-1.665 0-3.015 1.355-3.015 3.015 0 1.665 1.35 3.015 3.015 3.015 1.663 0 3.015-1.35 3.015-3.015zm-5.273-.005c0-1.252 1.013-2.266 2.265-2.266 1.249 0 2.266 1.014 2.266 2.266 0 1.251-1.017 2.265-2.266 2.265-1.253 0-2.265-1.014-2.265-2.265z"
                />
              </svg>
            </a>
          </div>

          <button
            class="nav-toggle"
            id="nav-toggle"
            aria-label="Toggle navigation"
            aria-expanded="false"
          >
            <span></span>
            <span></span>
            <span></span>
          </button>
        </div>
      </nav>
    </header>

    <main class="main-content">
      <div class="container">
        <div class="orders-container">
          <div class="orders-header">
            <h1>Your Orders</h1>
            <p>View and manage your purchase history</p>
          </div>

          <div id="orders-content">
            <!-- Content will be loaded dynamically -->
          </div>

          <div class="actions">
            <a href="index.html" class="btn btn-primary">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M19 12H5M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              Back to Home
            </a>
            <button id="logout-btn" class="btn btn-secondary">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M16 17L21 12L16 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M21 12H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              Logout
            </button>
          </div>
        </div>
      </div>
    </main>

    <script>
      // Check authentication and load orders
      document.addEventListener('DOMContentLoaded', function() {
        const currentUser = localStorage.getItem('windhelm_user');
        const ordersContent = document.getElementById('orders-content');
        const logoutBtn = document.getElementById('logout-btn');

        if (!currentUser) {
          // Not authenticated, redirect to home
          window.location.href = 'index.html';
          return;
        }

        // Show user info
        ordersContent.innerHTML = `
          <div class="user-info">
            <p>Welcome back, <span class="username">${currentUser}</span>!</p>
          </div>
          <div class="loading">
            <div class="spinner"></div>
            <p>Loading your orders...</p>
          </div>
        `;

        // Fetch orders
        fetchOrders(currentUser);

        // Logout functionality
        logoutBtn.addEventListener('click', function() {
          localStorage.removeItem('windhelm_user');
          window.location.href = 'index.html';
        });
      });

      async function fetchOrders(username) {
        const ordersContent = document.getElementById('orders-content');

        try {
          const response = await fetch(`http://localhost:3000/api/orders?username=${encodeURIComponent(username)}`);
          const orders = await response.json();

          if (orders.length === 0) {
            ordersContent.innerHTML = `
              <div class="user-info">
                <p>Welcome back, <span class="username">${username}</span>!</p>
              </div>
              <div class="no-orders">
                <p>No orders found</p>
                <p class="subtitle">You haven't made any purchases yet.</p>
              </div>
            `;
          } else {
            const ordersList = orders.map(order => `
              <div class="order-item">
                <div class="order-header">
                  <h3 class="order-id">Order #${order.orderId}</h3>
                  <span class="order-date">${new Date(order.date).toLocaleDateString()}</span>
                </div>
                <div class="order-details">
                  <p><strong>Item:</strong> ${order.item}</p>
                </div>
              </div>
            `).join('');

            ordersContent.innerHTML = `
              <div class="user-info">
                <p>Welcome back, <span class="username">${username}</span>!</p>
              </div>
              <div class="orders-list">
                ${ordersList}
              </div>
            `;
          }
        } catch (error) {
          console.error('Error fetching orders:', error);
          ordersContent.innerHTML = `
            <div class="user-info">
              <p>Welcome back, <span class="username">${username}</span>!</p>
            </div>
            <div class="error">
              <p>Unable to load orders. Please try again.</p>
            </div>
          `;
        }
      }

      // Navigation functionality (simplified)
      const navToggle = document.getElementById('nav-toggle');
      const navMenu = document.getElementById('nav-menu');

      if (navToggle && navMenu) {
        navToggle.addEventListener('click', function() {
          navMenu.classList.toggle('active');
          navToggle.classList.toggle('active');
          const isExpanded = navToggle.getAttribute('aria-expanded') === 'true';
          navToggle.setAttribute('aria-expanded', !isExpanded);
        });

        // Close menu when clicking links
        navMenu.querySelectorAll('.nav-link').forEach(link => {
          link.addEventListener('click', function() {
            navMenu.classList.remove('active');
            navToggle.classList.remove('active');
            navToggle.setAttribute('aria-expanded', 'false');
          });
        });
      }
    </script>
  </body>
</html>